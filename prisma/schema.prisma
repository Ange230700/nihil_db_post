// post\prisma\schema.prisma

generator client {
  provider = "prisma-client-js"
  output   = "./generated/client"
  binaryTargets = ["native", "windows", "debian-openssl-3.0.x"]
}

datasource db {
  provider = "mysql"
  url      = env("POST_DATABASE_URL")
}

model post {
  id             String   @id @default(uuid())
  userId         String
  content        String
  mediaUrl       String?
  createdAt      DateTime @default(now())
  updatedAt      DateTime @updatedAt
  isDeleted      Boolean  @default(false)
  originalPostId String? // Self-reference for shares

  // Relations
  originalPost post?  @relation("Reshare", fields: [originalPostId], references: [id])
  shares       post[] @relation("Reshare")

  @@index([userId])
  @@index([originalPostId])
}
